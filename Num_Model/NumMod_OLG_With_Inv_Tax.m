%DRAW DISTRIBUTIONSclear all;clc;pkg load statistics;A_1=2;A_2=A_1*3.0; %1.02^35=2 and 1.025=2.37delta=0.9; %0.9^35=0.02K_bar=0.7; %0.6alpha=0.4; %oksigma=1.0;dam1=0.8;dam2=0.4;eta=1.5; %1.5 nordhausbeta=0.6; %0.995^35=0.84 and 0.99^35=0.7 and 0.985^35=0.59 nordhauslambda_0=0.0;mu_0=0.2; %0.2mu_step=0.1; %0.1f1 = figure;f2 = figure;f3 = figure;f4 = figure;mu_sol=[];CoGrowth=[];r_2_y=[];tau_E=[];I_1=[];C_1=[];nb_round = 25lambda=lambda_0n_lambda = 3for i=1:n_lambda  mu=mu_0;mu_sol(:,i) = [1:nb_round];CoGrowth(:,i) = [1:nb_round];r_2_y(:,i) = [1:nb_round];tau_E(:,i) = [1:nb_round];I_1(:,i) = [1:nb_round];E_1(:,i) = [1:nb_round];C_1(:,i) = [1:nb_round];for j=1:nb_round  if (lambda > mu)  gamma = lambda;else  gamma = mu;endif%Notation: x(1)=c_1a, x(2)=c_1b, x(3)=c_2b, x(4)=c_2c, x(5)=I_1, x(6)=E_1f=@(x)([x(3)+x(4)-A_2*((1-delta)*K_bar+x(5))^alpha+dam1*(sigma*A_1*K_bar^alpha-x(6))+dam2*(sigma*A_1*K_bar^alpha-x(6))^2,...x(3)^(-eta)-gamma*x(4)^(-eta),...x(1)+x(2)+x(5)-A_1*K_bar^alpha+0.2*x(6)^2,...x(1)^(-eta)-gamma*x(2)^(-eta),...x(2)^(-eta)-beta*x(3)^(-eta)*alpha*A_2*((1-delta)*K_bar+x(5))^(alpha-1)*(1-(gamma-lambda)/(gamma+gamma^((eta-1)/eta))),...x(2)^(-eta)*0.4*x(6)-beta*x(3)^(-eta)*(dam1+dam2*2*(sigma*A_1*K_bar^alpha-x(6)))*(1-(gamma-lambda)/(gamma+gamma^((eta-1)/eta)))]);x0=[1.0,1.0,1.0,1.0,1.0,1.0];xroot=fsolve(f,x0);mu_sol(j,i)=mu;CoGrowth(j,i) = (((xroot(4)+xroot(3))/(xroot(1)+xroot(2)))^(1/35)-1)*100;r_2_y(j,i) = (((xroot(5)+(1-delta)*K_bar)^(alpha-1)*A_2*alpha)^(1/35)-1)*100;tau_E(j,i) = 1/((xroot(5)+(1-delta)*K_bar)^(alpha-1)*A_2*alpha)*(dam1+dam2*2*(sigma*A_1*K_bar^alpha-xroot(6)));I_1(j,i) = xroot(5);E_1(j,i) = xroot(6);C_1(j,i) = xroot(1)+xroot(2);mu=mu+mu_step;endlambda=lambda+0.5;figure(f1);x_g = mu_sol(:,i)y_g = CoGrowth(:,i)plot(x_g,y_g, 'LineWidth', 2,'Color',[0 0 0]+0.4);hold onfigure(f2);x_g = mu_sol(:,i)y_g = r_2_y(:,i)plot(x_g,y_g, 'LineWidth', 2,'Color',[0 0 0]+0.4);hold onfigure(f3);x_g = mu_sol(:,i)y_g = r_2_y(:,i)plot(x_g,y_g, 'LineWidth', 2,'Color',[0 0 0]+0.4);hold onfigure(f4);x_g = mu_sol(:,i)y_g = I_1(:,i)plot(x_g,y_g, 'LineWidth', 2,'Color',[0 0 0]+0.4);hold onendfichier = 'results.csv';delete(fichier)para = 4col_names = [];for i = 1 : n_lambdanb = 1+para*(i-1)col_names(nb) = nb;nb = 2+para*(i-1)col_names(nb) = nb;nb = 3+para*(i-1)col_names(nb) = nb;nb = 4+para*(i-1)col_names(nb) = nb;enddlmwrite(fichier,col_names,'-append')for j = 1 : nb_roundlist = [];for i = 1 : n_lambdanb = 1+para*(i-1)list(nb) = mu_sol(j,i);nb = 2+para*(i-1)list(nb) = r_2_y(j,i);nb = 3+para*(i-1)list(nb) = r_2_y(j,i);nb = 4+para*(i-1)list(nb) = CoGrowth(j,i);enddlmwrite(fichier,list,'-append','precision',5)end